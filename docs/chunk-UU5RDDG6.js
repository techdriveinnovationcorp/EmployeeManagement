import{a as U,b as _,c as G,e as H,f as J,g as Y,h as V,i as q,j as W,m as X,n as Z,o as $,r as K}from"./chunk-G3RRGCM3.js";import{a as z,b as Q}from"./chunk-RBHPZCP3.js";import{a as F,b as B,d as T,e as v,h as P,k,l as w,m as it,n as x,o as g}from"./chunk-TE4P23CZ.js";import{P as R,a as L}from"./chunk-KBH2GQER.js";import{f as N,i as A}from"./chunk-3D6W6ZOO.js";import"./chunk-IX6G3U3V.js";import{Ec as E,Ic as I,Nb as u,Ob as C,Xa as f,Ya as p,da as j,na as O,nb as M,oa as D,pb as h,vb as d,wb as r,xb as m}from"./chunk-WSRERBCD.js";import"./chunk-VEDS6FP2.js";import{a as y,h as et,j as S}from"./chunk-ZC6IZ3YH.js";var b=et(it());function ot(n,o){n&1&&(d(0,"div",11)(1,"div",12),m(2,"span",13)(3,"div",14),r(),d(4,"div",12),m(5,"span",13)(6,"div",14),r(),d(7,"div",12),m(8,"span",13)(9,"div",14),r()())}function rt(n,o){n&1&&(d(0,"div",11)(1,"div",15)(2,"span"),u(3,"Department Id "),r(),m(4,"input",16),r(),d(5,"div",15)(6,"span"),u(7,"Department Name "),r(),m(8,"input",17),r(),d(9,"div",15)(10,"span"),u(11,"Status "),r(),m(12,"mat-slide-toggle",18),r()()),n&2&&(f(12),h("color","primary"))}var tt=(()=>{let o=class o{constructor(t,e,a,i,s,c,l){this.dataProvider=t,this.appUtils=e,this.route=a,this.layoutConfig=i,this.fb=s,this.firebaseProvider=c,this.snackBar=l,this.recordId="",this.isSkeletonLoading=!1,this.layoutName="department_ENTRY",this.layoutDisplayName=this.layoutConfig.layoutConfiguration[this.layoutName].layoutDisplayName,this.headerActionInfo=(0,b.cloneDeep)(this.layoutConfig.layoutConfiguration[this.layoutName].headerActionInfo),this.mappingDetails=(0,b.cloneDeep)(this.layoutConfig.layoutConfiguration[this.layoutName].mappingDetails),this.objectHierarchy=[{objectName:"department",objectType:"primary",rootPath:"department_DUMMY",primaryFieldName:"departmentid",primaryFieldNamePrefix:"dprt_",childObject:[]}],this.dataObject={},this.departmentdetails=this.fb.group({department_DUMMY:this.fb.group({departmentid:[""],departmentname:[""],status:[!0],createdBy:[this.appUtils.appConfig.userMail],modifiedBy:[this.appUtils.appConfig.userMail],createdAt:[new Date().toLocaleString()],modifiedAt:[new Date().toLocaleString()],type:"department"})})}showSnackBar(t,e){this.snackBar.open(t,"Close",{duration:e||3e3,horizontalPosition:"center",verticalPosition:"bottom"})}ngOnInit(){this.route.queryParams.subscribe(t=>{t.data!==void 0&&JSON.parse(t.data).id&&(this.recordId=JSON.parse(t.data).id,this.recordId&&this.fetchForEditRecord().then(e=>{e&&(this.showSnackBar("data fetch successfully",3e3),this.isSkeletonLoading=!1)}))})}fetchForEditRecord(){return S(this,null,function*(){this.isSkeletonLoading=!!this.recordId;try{let t=yield this.dataProvider.fetch(this.objectHierarchy,this.recordId,this);return this.updateFormDataAfterSave(this.dataObject,this.departmentdetails),t}catch(t){console.error("Error fetching data:",t)}finally{this.isSkeletonLoading=!1}})}updateFormDataAfterSave(t,e){Object.keys(t).forEach(a=>{let i=t[a],s=e.controls[a];s&&Object.keys(i).forEach(c=>{let l=s.get(c);l&&l.setValue(i[c])})})}save(){this.appUtils.isMainloading=!0;let t=[this.departmentdetails.value];this.dirtyStatus=this.checkFormDirtyStatus(),this.setDataObject(t),console.log("Data Object to Save:",this.dataObject),this.isSkeletonLoading=!0,this.dataProvider.handleSave(t,this.objectHierarchy[0],"",this).then(e=>{console.log("Primary object saved with ID and Rev:",e),this.recordId=e.id,this.recordRev=e.rev,this.fetchForEditRecord(),this.appUtils.isMainloading=!1,this.isSkeletonLoading=!1;let a=this.recordId!==""?"Record Updated successfully":"Record saved successfully";this.showSnackBar(a)}).catch(e=>{console.error("Error during save:",e),this.showSnackBar(e,6e3),this.appUtils.isMainloading=!1,this.isSkeletonLoading=!1})}setDataObject(t){t.forEach(e=>{let a=y({},e);Object.keys(a).forEach(i=>{this.dataObject[i]?(this.dataObject[i].id=this.dataObject[i].id?this.dataObject[i].id:"",this.dataObject[i].rev=this.dataObject[i].rev?this.dataObject[i].rev:""):(this.dataObject[i]=y({},a[i]),this.dataObject[i].id=this.dataObject[i].id?this.dataObject[i].id:"",this.dataObject[i].rev=this.dataObject[i].rev?this.dataObject[i].rev:"")})})}checkFormDirtyStatus(){let t={},e=this.departmentdetails;return Object.keys(e.controls).forEach(a=>{let i=e.get(a);if(i)if(this.dataObject[a]){let s=JSON.parse(JSON.stringify(this.dataObject[a]));delete s.id,delete s.rev;let c=JSON.parse(JSON.stringify(i.value));Object.keys(c).forEach(l=>{c[l]===null&&delete c[l]}),Object.keys(s).forEach(l=>{s[l]===null&&delete s[l]}),t[a]=!this.objectsAreEqual(c,s)}else t[a]=!1}),console.log(t),t}objectsAreEqual(t,e){let a=Object.keys(t);for(let i of a)if(t[i]!==e[i])return!1;return!0}};o.\u0275fac=function(e){return new(e||o)(p(g),p(L),p(N),p(x),p(V),p(v),p(z))},o.\u0275cmp=O({type:o,selectors:[["department_ENTRY"]],decls:16,vars:6,consts:[[1,"dummyHeader"],[1,"pageHeader"],[1,"pageTitle"],[1,"pageButtonGroup"],[3,"buttonData","parentContext"],[1,"applicationContainer"],[1,"section",3,"formGroup"],[1,"sectionHeader"],[1,"sectionContent"],["class","row",4,"ngIf"],["class","row ",4,"ngIf"],[1,"row"],[1,"inputContainer"],[1,"fieldNameSkeleton"],[1,"inputFieldSkeleton"],["formGroupName","department_DUMMY",1,"inputContainer"],["type","text","readonly","","formControlName","departmentid",1,"readOnlyTextBox"],["type","text","formControlName","departmentname"],["formControlName","status",3,"color"]],template:function(e,a){e&1&&(m(0,"div",0)(1,"div",0),d(2,"div",1)(3,"div",2)(4,"h2"),u(5),r()(),d(6,"div",3),m(7,"app-layout-action-buttons",4),r()(),d(8,"div",5)(9,"div",6)(10,"div",7)(11,"span"),u(12,"Department Details"),r()(),d(13,"div",8),M(14,ot,10,0,"div",9)(15,rt,13,1,"div",10),r()()()),e&2&&(f(5),C(a.layoutDisplayName),f(2),h("buttonData",a.headerActionInfo)("parentContext",a),f(2),h("formGroup",a.departmentdetails),f(5),h("ngIf",a.isSkeletonLoading),f(),h("ngIf",!a.isSkeletonLoading))},dependencies:[E,k,U,_,G,H,Y,J,Z],encapsulation:2});let n=o;return n})();var nt=[{path:"",component:tt}],Rt=(()=>{let o=class o{};o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=D({type:o}),o.\u0275inj=j({providers:[v,g,{provide:W,useValue:{color:"primary"}}],imports:[I,P,w,q,F.initializeApp(B),T,Q,R,X,$,K,A.forChild(nt)]});let n=o;return n})();export{Rt as department_ENTRYModule};
